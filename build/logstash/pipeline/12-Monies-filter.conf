filter {
  if [type] == "Monies" {
	mutate {
		add_field => { 
			"MachineName" => "%{[Properties][MachineName]}"
			"AppName" => "%{[Properties][AppName]}"
			"ThreadId" => "%{[Properties][ThreadId]}"
		}
		remove_field => ["@version", "[Properties][MachineName]", "[Properties][AppName]", "[Properties][ThreadId]"]	
	}
    if [MessageTemplate] =~ "Operation Provider Request:" {
      grok {
        match => { "MessageTemplate" => "Operation Provider Request: %{GREEDYDATA:RequestData}" }
      }
      json {
        source => "RequestData"
        add_field => { "operationId" => "%{[Operation][OperationId]}" }
        add_field => { "provider" => "%{[Operation][Provider]}" }
        target => "Operation"
      }
      mutate {
        remove_field => [ "Operation", "RequestData" ]
      }
    }
  }
}